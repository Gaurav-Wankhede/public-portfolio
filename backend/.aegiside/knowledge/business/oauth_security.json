{
  "schema_version": "1.0.0",
  "last_updated": "2025-11-01T14:31:00+05:30",
  "authentication_flows": {
    "browser_login": {
      "type": "OAuth 2.0 Authorization Code with PKCE",
      "steps": ["User clicks login", "Opens system browser", "Logs in at auth.aegiside.com", "Redirects to localhost:8899/callback", "App exchanges code for tokens"]
    },
    "device_code": {
      "type": "Device Code Flow",
      "steps": ["User logs into aegiside.com/account", "Generates 6-digit PIN (10min expiry)", "Enters PIN in desktop app", "App exchanges PIN for tokens"]
    }
  },
  "security_mechanisms": {
    "device_fingerprinting": {
      "algorithm": "SHA256(cpu_serial + mac_address + hostname + os)",
      "purpose": "Hardware-based unique ID, stable across reboots"
    },
    "token_management": {
      "access_token": "1-hour lifespan (JWT format)",
      "refresh_token": "30-day lifespan, rotates on use",
      "binding": "Tokens tied to device_id, validated on every API call",
      "storage": "DPAPI (Windows), Keychain (macOS), Secret Service (Linux)"
    },
    "ip_anomaly_detection": {
      "flags": ["3+ countries in 24h", "Impossible travel", "1000+ API calls/hour"],
      "actions": ["Email alerts", "2FA re-verification", "Temporary lock"]
    }
  },
  "api_endpoints": {
    "oauth": ["/oauth/authorize", "/oauth/token", "/oauth/device/code", "/oauth/device/token"],
    "license": ["/api/v1/license/status", "/api/v1/devices", "/api/v1/devices/{id}"]
  }
}
